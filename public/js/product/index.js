(()=>{var e=document.getElementById("category-select"),t=document.getElementById("sizes-select"),n=document.getElementById("filter-form"),i=document.getElementById("product-list"),o=document.getElementById("pagination"),a=document.getElementById("no-products"),r=document.getElementById("reset-filters"),l=document.getElementById("min-price"),c=document.getElementById("max-price"),u=document.getElementById("sort-select"),s=document.getElementById("scrollToTopBtn"),d=!1,v=new URLSearchParams(window.location.search),m=v.get("size")||"",h=v.get("category")||"";s.onclick=function(){window.scrollTo({top:0,behavior:"smooth"})};var f=function(){document.querySelectorAll(".image-container").forEach((function(e){var t=Array.from(e.querySelectorAll("img")),n=e.querySelector(".nav-button.left"),i=e.querySelector(".nav-button.right");if(0!==t.length){var o=0,a=0,r=0;t[o].classList.add("active");var l=function(e){t.forEach((function(t,n){t.classList.toggle("active",n===e)})),o=e};n&&n.addEventListener("click",(function(){var e=(o-1+t.length)%t.length;l(e)})),i&&i.addEventListener("click",(function(){var e=(o+1)%t.length;l(e)})),e.addEventListener("touchstart",(function(e){a=e.touches[0].clientX})),e.addEventListener("touchmove",(function(e){r=e.touches[0].clientX})),e.addEventListener("touchend",(function(){var e=r-a;if(e<-50){var n=(o+1)%t.length;l(n)}if(e>50){var i=(o-1+t.length)%t.length;l(i)}}))}}))},g=function(e){""===e?(t.innerHTML='<option value="">All Sizes</option>',t.value="",t.disabled=!0):fetch("/category/".concat(e,"/sizes")).then((function(e){return e.json()})).then((function(e){t.innerHTML='<option value="">All Sizes</option>',t.disabled=!1;var n=!1;e.forEach((function(e){var i=document.createElement("option");i.value=e.id,i.textContent=e.size_name,e.id==m&&(i.selected=!0,n=!0),t.appendChild(i)})),n||(t.value="")})).catch((function(e){console.error("Error fetching sizes:",e)}))},y=function(e,t,n,i,o){var a=new URL(window.location.href),r=new URLSearchParams(a.search);""===e?r.delete("category"):r.set("category",e),""===t?r.delete("size"):r.set("size",t),""===n&&""===i?(r.delete("min_price"),r.delete("max_price")):(n&&r.set("min_price",n),i&&r.set("max_price",i)),""===o?r.delete("sort"):r.set("sort",o),r.toString()?window.history.replaceState({},"","".concat(a.pathname,"?").concat(r.toString())):history.replaceState({},"",window.location.pathname)},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];d=!0,fetch("/?".concat(new URLSearchParams(e).toString())).then((function(e){return e.text()})).then((function(e){var n=(new DOMParser).parseFromString(e,"text/html"),r=n.querySelector("#product-list"),l=n.querySelector("#pagination");r&&r.innerHTML.trim()?(t?i.insertAdjacentHTML("beforeend",r.innerHTML):i.innerHTML=r.innerHTML,f(),o.innerHTML=l.innerHTML,a.style.display="none"):(i.innerHTML="",a.style.display="block"),d=!1})).catch((function(e){console.error("Error loading products:",e),d=!1}))};h&&(e.value=h,g(h)),t.value=m,n.addEventListener("submit",(function(i){i.preventDefault();var o=new FormData(n);p(o);var a=e.value,r=t.value,s=l.value,d=c.value,v=u.value;y(a,r,s,d,v)})),e.addEventListener("change",(function(){var e=this.value;g(e),y(e,t.value,l.value,c.value,u.value)})),t.addEventListener("change",(function(){y(e.value,this.value,l.value,c.value,u.value)})),l.addEventListener("input",(function(){y(e.value,t.value,this.value,c.value,u.value)})),c.addEventListener("input",(function(){y(e.value,t.value,l.value,this.value,u.value)})),u.addEventListener("change",(function(){y(e.value,t.value,l.value,c.value,this.value)})),null!==r&&r.addEventListener("click",(function(){n.reset(),y("","","","",""),p(new FormData(n))})),window.addEventListener("scroll",(function(){if(window.scrollY+window.innerHeight>=document.documentElement.scrollHeight-100&&!d){var e=new FormData(n),t=o.querySelector('a[rel="next"]');t&&(e.set("page",t.getAttribute("href").split("page=")[1]),p(e,!0))}document.body.scrollTop>600||document.documentElement.scrollTop>600?(s.style.opacity=1,s.style.visibility="visible"):(s.style.opacity=0,s.style.visibility="hidden")})),f()})();