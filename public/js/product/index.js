(()=>{var e=document.getElementById("category-select"),t=document.getElementById("sizes-select"),n=document.getElementById("filter-form"),a=document.getElementById("product-list"),i=document.getElementById("pagination"),r=document.getElementById("no-products"),o=document.getElementById("reset-filters"),c=document.getElementById("min-price"),l=document.getElementById("max-price"),u=document.getElementById("sort-select"),d=!1,s=new URLSearchParams(window.location.search),v=s.get("size")||"",m=s.get("category")||"",h=function(){document.querySelectorAll(".image-container").forEach((function(e){var t=Array.from(e.querySelectorAll("img")),n=e.querySelector(".nav-button.left"),a=e.querySelector(".nav-button.right");if(0!==t.length){var i=0,r=0,o=0;t[i].classList.add("active");var c=function(e){t.forEach((function(t,n){t.classList.toggle("active",n===e)})),i=e};n&&n.addEventListener("click",(function(){var e=(i-1+t.length)%t.length;c(e)})),a&&a.addEventListener("click",(function(){var e=(i+1)%t.length;c(e)})),e.addEventListener("touchstart",(function(e){r=e.touches[0].clientX})),e.addEventListener("touchmove",(function(e){o=e.touches[0].clientX})),e.addEventListener("touchend",(function(){var e=o-r;if(e<-50){var n=(i+1)%t.length;c(n)}if(e>50){var a=(i-1+t.length)%t.length;c(a)}}))}}))},f=function(e){""===e?(t.innerHTML='<option value="">All Sizes</option>',t.value="",t.disabled=!0):fetch("/category/".concat(e,"/sizes")).then((function(e){return e.json()})).then((function(e){t.innerHTML='<option value="">All Sizes</option>',t.disabled=!1;var n=!1;e.forEach((function(e){var a=document.createElement("option");a.value=e.id,a.textContent=e.size_name,e.id==v&&(a.selected=!0,n=!0),t.appendChild(a)})),n||(t.value="")})).catch((function(e){console.error("Error fetching sizes:",e)}))},g=function(e,t,n,a,i){var r=new URL(window.location.href),o=new URLSearchParams(r.search);""===e?o.delete("category"):o.set("category",e),""===t?o.delete("size"):o.set("size",t),""===n&&""===a?(o.delete("min_price"),o.delete("max_price")):(n&&o.set("min_price",n),a&&o.set("max_price",a)),""===i?o.delete("sort"):o.set("sort",i),o.toString()?window.history.replaceState({},"","".concat(r.pathname,"?").concat(o.toString())):history.replaceState({},"",window.location.pathname)},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];d=!0,fetch("/?".concat(new URLSearchParams(e).toString())).then((function(e){return e.text()})).then((function(e){var n=(new DOMParser).parseFromString(e,"text/html"),o=n.querySelector("#product-list"),c=n.querySelector("#pagination");o&&o.innerHTML.trim()?(t?a.insertAdjacentHTML("beforeend",o.innerHTML):a.innerHTML=o.innerHTML,h(),i.innerHTML=c.innerHTML,r.style.display="none"):(a.innerHTML="",r.style.display="block"),d=!1})).catch((function(e){console.error("Error loading products:",e),d=!1}))};m&&(e.value=m,f(m)),t.value=v,n.addEventListener("submit",(function(a){a.preventDefault();var i=new FormData(n);p(i);var r=e.value,o=t.value,d=c.value,s=l.value,v=u.value;g(r,o,d,s,v)})),e.addEventListener("change",(function(){var e=this.value;f(e),g(e,t.value,c.value,l.value,u.value)})),t.addEventListener("change",(function(){g(e.value,this.value,c.value,l.value,u.value)})),c.addEventListener("input",(function(){g(e.value,t.value,this.value,l.value,u.value)})),l.addEventListener("input",(function(){g(e.value,t.value,c.value,this.value,u.value)})),u.addEventListener("change",(function(){g(e.value,t.value,c.value,l.value,this.value)})),null!==o&&o.addEventListener("click",(function(){n.reset(),g("","","","",""),p(new FormData(n))})),window.addEventListener("scroll",(function(){if(window.scrollY+window.innerHeight>=document.documentElement.scrollHeight-100&&!d){var e=new FormData(n),t=i.querySelector('a[rel="next"]');t&&(e.set("page",t.getAttribute("href").split("page=")[1]),p(e,!0))}})),h()})();