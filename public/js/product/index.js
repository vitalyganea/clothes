(()=>{var e=document.getElementById("category-select"),t=document.getElementById("sizes-select"),n=document.getElementById("filter-form"),r=document.getElementById("product-list"),i=document.getElementById("pagination"),o=document.getElementById("no-products"),a=document.getElementById("reset-filters"),c=document.getElementById("min-price"),l=document.getElementById("max-price"),d=document.getElementById("sort-select"),u=document.getElementById("city-select"),s=!1,v=new URLSearchParams(window.location.search),m=v.get("size")||"",g=v.get("category")||"",h=function(){document.querySelectorAll(".image-container").forEach((function(e){var t=Array.from(e.querySelectorAll("img")),n=e.querySelector(".nav-button.left"),r=e.querySelector(".nav-button.right");if(0!==t.length){var i=0,o=0,a=0;t[i].classList.add("active");var c=function(e){t.forEach((function(t,n){t.classList.toggle("active",n===e)})),i=e};n&&n.addEventListener("click",(function(){var e=(i-1+t.length)%t.length;c(e)})),r&&r.addEventListener("click",(function(){var e=(i+1)%t.length;c(e)})),e.addEventListener("touchstart",(function(e){o=e.touches[0].clientX})),e.addEventListener("touchmove",(function(e){a=e.touches[0].clientX})),e.addEventListener("touchend",(function(){var e=a-o;if(e<-50){var n=(i+1)%t.length;c(n)}if(e>50){var r=(i-1+t.length)%t.length;c(r)}}))}}))},f=function(e){""===e?(t.innerHTML='<option value="">All Sizes</option>',t.value="",t.disabled=!0):fetch("/category/".concat(e,"/sizes")).then((function(e){return e.json()})).then((function(e){t.innerHTML='<option value="">All Sizes</option>',t.disabled=!1;var n=!1;e.forEach((function(e){var r=document.createElement("option");r.value=e.id,r.textContent=e.size_name,e.id==m&&(r.selected=!0,n=!0),t.appendChild(r)})),n||(t.value="")})).catch((function(e){console.error("Error fetching sizes:",e)}))},y=function(e,t,n,r,i,o){var a=new URL(window.location.href),c=new URLSearchParams(a.search);""===e?c.delete("category"):c.set("category",e),""===t?c.delete("size"):c.set("size",t),""===n&&""===r?(c.delete("min_price"),c.delete("max_price")):(n&&c.set("min_price",n),r&&c.set("max_price",r)),""===i?c.delete("sort"):c.set("sort",i),""===o||void 0===o?c.delete("city"):c.set("city",o),c.toString()?window.history.replaceState({},"","".concat(a.pathname,"?").concat(c.toString())):history.replaceState({},"",window.location.pathname)},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];s=!0,fetch("/?".concat(new URLSearchParams(e).toString())).then((function(e){return e.text()})).then((function(e){var n=(new DOMParser).parseFromString(e,"text/html"),a=n.querySelector("#product-list"),c=n.querySelector("#pagination");a&&a.innerHTML.trim()?(t?r.insertAdjacentHTML("beforeend",a.innerHTML):r.innerHTML=a.innerHTML,h(),i.innerHTML=c.innerHTML,o.style.display="none"):(r.innerHTML="",o.style.display="block"),s=!1})).catch((function(e){console.error("Error loading products:",e),s=!1}))};function E(){y(e.value,t.value,c.value,l.value,d.value,u.value)}g&&(e.value=g,f(g)),t.value=m,n.addEventListener("submit",(function(r){r.preventDefault();var i=new FormData(n);p(i);var o=e.value,a=t.value,s=c.value,v=l.value,m=d.value,g=u.value;y(o,a,s,v,m,g)})),e.addEventListener("change",(function(){f(this.value),E()})),t.addEventListener("change",E),c.addEventListener("input",E),l.addEventListener("input",E),d.addEventListener("change",E),u.addEventListener("change",E),null!==a&&a.addEventListener("click",(function(){n.reset(),y("","","","",""),p(new FormData(n))})),window.addEventListener("scroll",(function(){if(window.scrollY+window.innerHeight>=document.documentElement.scrollHeight-100&&!s){var e=new FormData(n),t=i.querySelector('a[rel="next"]');t&&(e.set("page",t.getAttribute("href").split("page=")[1]),p(e,!0))}})),h()})();